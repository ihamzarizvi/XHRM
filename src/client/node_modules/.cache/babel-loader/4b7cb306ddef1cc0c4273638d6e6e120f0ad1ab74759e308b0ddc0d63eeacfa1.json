{"ast":null,"code":"import { renderSlot as _renderSlot, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock, vShow as _vShow, withDirectives as _withDirectives, createTextVNode as _createTextVNode, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = {\n  class: \"XHRM-timesheet-header\"\n};\nconst _hoisted_2 = {\n  class: \"XHRM-timesheet-header--title\"\n};\nconst _hoisted_3 = {\n  class: \"XHRM-timesheet-header--options\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"XHRM-timesheet-loader\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"XHRM-timesheet-body-message\"\n};\nconst _hoisted_6 = {\n  key: 2,\n  class: \"XHRM-timesheet-body\"\n};\nconst _hoisted_7 = {\n  class: \"XHRM-timesheet-table-header\"\n};\nconst _hoisted_8 = {\n  class: \"XHRM-timesheet-table-header-row\"\n};\nconst _hoisted_9 = {\n  class: \"XHRM-timesheet-table-header-cell\"\n};\nconst _hoisted_10 = {\n  class: \"--day\"\n};\nconst _hoisted_11 = {\n  key: 0,\n  class: \"XHRM-timesheet-table-header-cell --center --freeze-right\"\n};\nconst _hoisted_12 = {\n  class: \"XHRM-timesheet-table-body\"\n};\nconst _hoisted_13 = {\n  key: 1\n};\nconst _hoisted_14 = {\n  class: \"XHRM-timesheet-table-body-cell\"\n};\nconst _hoisted_15 = {\n  key: 1\n};\nconst _hoisted_16 = {\n  key: 1\n};\nconst _hoisted_17 = {\n  key: 0,\n  class: \"XHRM-timesheet-table-body-cell --center --freeze-right --highlight\"\n};\nconst _hoisted_18 = {\n  key: 1,\n  class: \"XHRM-timesheet-table-body-cell --flex\"\n};\nconst _hoisted_19 = {\n  key: 0,\n  class: \"XHRM-timesheet-table-body-row --total\"\n};\nconst _hoisted_20 = {\n  class: \"XHRM-timesheet-table-body-cell --freeze-left --highlight\"\n};\nconst _hoisted_21 = {\n  class: \"XHRM-timesheet-table-body-cell --center --freeze-right --highlight-2\"\n};\nconst _hoisted_22 = {\n  key: 1,\n  class: \"XHRM-timesheet-table-body-row\"\n};\nconst _hoisted_23 = {\n  class: \"XHRM-timesheet-table-body-cell --flex\"\n};\nconst _hoisted_24 = {\n  key: 2,\n  class: \"XHRM-timesheet-table-body-row\"\n};\nconst _hoisted_25 = {\n  colspan: \"9\",\n  class: \"XHRM-timesheet-table-body-cell\"\n};\nconst _hoisted_26 = {\n  class: \"XHRM-timesheet-footer\"\n};\nconst _hoisted_27 = {\n  class: \"XHRM-timesheet-footer--title\"\n};\nconst _hoisted_28 = {\n  class: \"XHRM-timesheet-footer--options\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_oxd_loading_spinner = _resolveComponent(\"oxd-loading-spinner\");\n  const _component_oxd_alert = _resolveComponent(\"oxd-alert\");\n  const _component_project_autocomplete = _resolveComponent(\"project-autocomplete\");\n  const _component_activity_dropdown = _resolveComponent(\"activity-dropdown\");\n  const _component_oxd_icon_button = _resolveComponent(\"oxd-icon-button\");\n  const _component_oxd_input_field = _resolveComponent(\"oxd-input-field\");\n  const _component_oxd_text = _resolveComponent(\"oxd-text\");\n  const _component_timesheet_comment_modal = _resolveComponent(\"timesheet-comment-modal\");\n  const _component_oxd_form = _resolveComponent(\"oxd-form\");\n  return _openBlock(), _createBlock(_component_oxd_form, {\n    class: \"XHRM-paper-container\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_renderSlot(_ctx.$slots, \"header-title\", {}, undefined, true)]), _createElementVNode(\"div\", _hoisted_3, [_renderSlot(_ctx.$slots, \"header-options\", {}, undefined, true)])]), $props.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createVNode(_component_oxd_loading_spinner)])) : !$props.loading && !$props.columns ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createVNode(_component_oxd_alert, {\n      type: \"warn\",\n      show: true,\n      message: _ctx.$t('time.no_timesheets_found')\n    }, null, 8, [\"message\"])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"table\", {\n      class: _normalizeClass($options.tableClasses)\n    }, [_createElementVNode(\"thead\", _hoisted_7, [_createElementVNode(\"tr\", _hoisted_8, [_createElementVNode(\"th\", {\n      class: _normalizeClass($options.fixedColumnClasses)\n    }, _toDisplayString(_ctx.$t('time.project')), 3), _createElementVNode(\"th\", _hoisted_9, _toDisplayString(_ctx.$t('time.activity')), 1), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.daysOfWeek, day => {\n      return _openBlock(), _createElementBlock(\"th\", {\n        key: day.id,\n        class: \"XHRM-timesheet-table-header-cell --center\"\n      }, [_createElementVNode(\"span\", _hoisted_10, _toDisplayString(day.day), 1), _createElementVNode(\"span\", null, _toDisplayString(day.title), 1)]);\n    }), 128)), !$props.editable ? (_openBlock(), _createElementBlock(\"th\", _hoisted_11, _toDisplayString(_ctx.$t('general.total')), 1)) : _createCommentVNode(\"\", true)])]), _createElementVNode(\"tbody\", _hoisted_12, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.records, (record, i) => {\n      return _openBlock(), _createElementBlock(\"tr\", {\n        key: record,\n        class: \"XHRM-timesheet-table-body-row\"\n      }, [_createElementVNode(\"td\", {\n        class: _normalizeClass($options.fixedCellClasses)\n      }, [$props.editable ? (_openBlock(), _createBlock(_component_project_autocomplete, {\n        key: 0,\n        \"only-allowed\": false,\n        rules: $data.rules.project,\n        \"model-value\": $options.getProject(record),\n        \"onUpdate:modelValue\": $event => $options.updateProject($event, i)\n      }, null, 8, [\"rules\", \"model-value\", \"onUpdate:modelValue\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_13, _toDisplayString(record.project ? `${record.customer.name} - ${record.project.name}` : ''), 1))], 2), _createElementVNode(\"td\", _hoisted_14, [$props.editable ? (_openBlock(), _createBlock(_component_activity_dropdown, {\n        key: 0,\n        rules: $data.rules.activity,\n        \"project-id\": record.project && record.project.id,\n        \"model-value\": $options.getActivity(record.activity),\n        \"onUpdate:modelValue\": $event => $options.updateActivity($event, i)\n      }, null, 8, [\"rules\", \"project-id\", \"model-value\", \"onUpdate:modelValue\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_15, _toDisplayString(record.activity && record.activity.name), 1))]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.columns, (column, date) => {\n        return _openBlock(), _createElementBlock(\"td\", {\n          key: `${record.project}_${record.activity}_${date}`,\n          class: _normalizeClass({\n            'XHRM-timesheet-table-body-cell': true,\n            '--center': true,\n            '--duration-input': $props.editable,\n            '--highlight-3': !$props.editable && column.workday\n          })\n        }, [_withDirectives(_createVNode(_component_oxd_icon_button, {\n          \"display-type\": \"secondary\",\n          class: \"XHRM-timesheet-icon-comment\",\n          name: $options.getCommentIcon(record.dates[date]),\n          onMousedown: $event => $options.viewComment(record, record.dates[date], i, date)\n        }, null, 8, [\"name\", \"onMousedown\"]), [[_vShow, $options.isCommentVisible(record.dates[date], i, date)]]), $props.editable ? (_openBlock(), _createBlock(_component_oxd_input_field, {\n          key: 0,\n          autocomplete: \"off\",\n          rules: $options.validateDuration(date),\n          \"model-value\": $options.getDuration(record.dates[date]),\n          onBlur: $options.onDurationBlur,\n          onFocus: $event => $options.onDurationFocus(i, date),\n          \"onUpdate:modelValue\": $event => $options.updateTime($event, i, date)\n        }, null, 8, [\"rules\", \"model-value\", \"onBlur\", \"onFocus\", \"onUpdate:modelValue\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_16, _toDisplayString($options.getDuration(record.dates[date]) ?? '00:00'), 1))], 2);\n      }), 128)), !$props.editable ? (_openBlock(), _createElementBlock(\"td\", _hoisted_17, _toDisplayString(record.total.label), 1)) : _createCommentVNode(\"\", true), $props.editable ? (_openBlock(), _createElementBlock(\"td\", _hoisted_18, [_createVNode(_component_oxd_icon_button, {\n        name: \"trash\",\n        class: \"XHRM-timesheet-icon\",\n        onClick: $event => $options.deleteRow(i)\n      }, null, 8, [\"onClick\"])])) : _createCommentVNode(\"\", true)]);\n    }), 128)), !$props.editable && $props.records.length > 0 ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_19, [_createElementVNode(\"td\", _hoisted_20, _toDisplayString(_ctx.$t('general.total')), 1), _cache[0] || (_cache[0] = _createElementVNode(\"td\", null, null, -1)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.columns, date => {\n      return _openBlock(), _createElementBlock(\"td\", {\n        key: `total-${date}`,\n        class: \"XHRM-timesheet-table-body-cell --center\"\n      }, _toDisplayString(date.total.label), 1);\n    }), 128)), _createElementVNode(\"td\", _hoisted_21, _toDisplayString($props.subtotal), 1)])) : _createCommentVNode(\"\", true), $props.editable ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_22, [_createElementVNode(\"td\", _hoisted_23, [_createVNode(_component_oxd_icon_button, {\n      name: \"plus\",\n      class: \"XHRM-timesheet-icon\",\n      onClick: $options.addRow\n    }, null, 8, [\"onClick\"]), _createVNode(_component_oxd_text, {\n      type: \"subtitle-2\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('time.add_row')), 1)]),\n      _: 1\n    })])])) : _createCommentVNode(\"\", true), $props.records.length === 0 ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_24, [_createElementVNode(\"td\", _hoisted_25, _toDisplayString(_ctx.$t('general.no_records_found')), 1)])) : _createCommentVNode(\"\", true)])], 2)])), _createElementVNode(\"div\", _hoisted_26, [_createElementVNode(\"div\", _hoisted_27, [_renderSlot(_ctx.$slots, \"footer-title\", {}, undefined, true)]), _createElementVNode(\"div\", _hoisted_28, [_renderSlot(_ctx.$slots, \"footer-options\", {}, undefined, true)])]), $data.showCommentModal ? (_openBlock(), _createBlock(_component_timesheet_comment_modal, {\n      key: 3,\n      editable: $props.editable,\n      data: $data.commentModalState,\n      \"timesheet-id\": $props.timesheetId,\n      onClose: $options.onCommentModalClose\n    }, null, 8, [\"editable\", \"data\", \"timesheet-id\", \"onClose\"])) : _createCommentVNode(\"\", true)]),\n    _: 3\n  });\n}","map":{"version":3,"names":["class","colspan","_createBlock","_component_oxd_form","_createElementVNode","_hoisted_1","_hoisted_2","_renderSlot","_ctx","$slots","undefined","_hoisted_3","$props","loading","_createElementBlock","_hoisted_4","_createVNode","_component_oxd_loading_spinner","columns","_hoisted_5","_component_oxd_alert","type","show","message","$t","_hoisted_6","_normalizeClass","$options","tableClasses","_hoisted_7","_hoisted_8","fixedColumnClasses","_hoisted_9","_toDisplayString","_Fragment","_renderList","daysOfWeek","day","key","id","_hoisted_10","title","editable","_hoisted_11","_hoisted_12","records","record","i","fixedCellClasses","_component_project_autocomplete","rules","$data","project","getProject","$event","updateProject","_hoisted_13","customer","name","_hoisted_14","_component_activity_dropdown","activity","getActivity","updateActivity","_hoisted_15","column","date","workday","_component_oxd_icon_button","getCommentIcon","dates","onMousedown","viewComment","isCommentVisible","_component_oxd_input_field","autocomplete","validateDuration","getDuration","onBlur","onDurationBlur","onFocus","onDurationFocus","updateTime","_hoisted_16","_hoisted_17","total","label","_hoisted_18","onClick","deleteRow","length","_hoisted_19","_hoisted_20","_hoisted_21","subtotal","_hoisted_22","_hoisted_23","addRow","_component_oxd_text","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","showCommentModal","_component_timesheet_comment_modal","data","commentModalState","timesheetId","onClose","onCommentModalClose"],"sources":["C:\\Users\\x\\Documents\\Projects\\HRM\\XHRM\\src\\client\\src\\XHRMTimePlugin\\components\\Timesheet.vue"],"sourcesContent":["<!--\n/**\n * XHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 XHRM Inc., http://www.XHRM.com\n *\n * XHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * XHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with XHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <oxd-form class=\"XHRM-paper-container\">\n    <div class=\"XHRM-timesheet-header\">\n      <div class=\"XHRM-timesheet-header--title\">\n        <slot name=\"header-title\"></slot>\n      </div>\n      <div class=\"XHRM-timesheet-header--options\">\n        <slot name=\"header-options\"></slot>\n      </div>\n    </div>\n\n    <div v-if=\"loading\" class=\"XHRM-timesheet-loader\">\n      <oxd-loading-spinner />\n    </div>\n    <div v-else-if=\"!loading && !columns\" class=\"XHRM-timesheet-body-message\">\n      <oxd-alert\n        type=\"warn\"\n        :show=\"true\"\n        :message=\"$t('time.no_timesheets_found')\"\n      ></oxd-alert>\n    </div>\n\n    <div v-else class=\"XHRM-timesheet-body\">\n      <table :class=\"tableClasses\">\n        <thead class=\"XHRM-timesheet-table-header\">\n          <tr class=\"XHRM-timesheet-table-header-row\">\n            <th :class=\"fixedColumnClasses\">\n              {{ $t('time.project') }}\n            </th>\n            <th class=\"XHRM-timesheet-table-header-cell\">\n              {{ $t('time.activity') }}\n            </th>\n\n            <!-- timesheet days of week -->\n            <th\n              v-for=\"day in daysOfWeek\"\n              :key=\"day.id\"\n              class=\"XHRM-timesheet-table-header-cell --center\"\n            >\n              <span class=\"--day\">\n                {{ day.day }}\n              </span>\n              <span>\n                {{ day.title }}\n              </span>\n            </th>\n            <!-- timesheet days of week -->\n\n            <th\n              v-if=\"!editable\"\n              class=\"XHRM-timesheet-table-header-cell --center --freeze-right\"\n            >\n              {{ $t('general.total') }}\n            </th>\n          </tr>\n        </thead>\n\n        <tbody class=\"XHRM-timesheet-table-body\">\n          <!-- timesheet activities -->\n          <tr\n            v-for=\"(record, i) in records\"\n            :key=\"record\"\n            class=\"XHRM-timesheet-table-body-row\"\n          >\n            <td :class=\"fixedCellClasses\">\n              <project-autocomplete\n                v-if=\"editable\"\n                :only-allowed=\"false\"\n                :rules=\"rules.project\"\n                :model-value=\"getProject(record)\"\n                @update:model-value=\"updateProject($event, i)\"\n              />\n              <span v-else>\n                {{\n                  record.project\n                    ? `${record.customer.name} - ${record.project.name}`\n                    : ''\n                }}\n              </span>\n            </td>\n            <td class=\"XHRM-timesheet-table-body-cell\">\n              <activity-dropdown\n                v-if=\"editable\"\n                :rules=\"rules.activity\"\n                :project-id=\"record.project && record.project.id\"\n                :model-value=\"getActivity(record.activity)\"\n                @update:model-value=\"updateActivity($event, i)\"\n              />\n              <span v-else>{{ record.activity && record.activity.name }}</span>\n            </td>\n            <td\n              v-for=\"(column, date) in columns\"\n              :key=\"`${record.project}_${record.activity}_${date}`\"\n              :class=\"{\n                'XHRM-timesheet-table-body-cell': true,\n                '--center': true,\n                '--duration-input': editable,\n                '--highlight-3': !editable && column.workday,\n              }\"\n            >\n              <oxd-icon-button\n                v-show=\"isCommentVisible(record.dates[date], i, date)\"\n                display-type=\"secondary\"\n                class=\"XHRM-timesheet-icon-comment\"\n                :name=\"getCommentIcon(record.dates[date])\"\n                @mousedown=\"viewComment(record, record.dates[date], i, date)\"\n              />\n              <oxd-input-field\n                v-if=\"editable\"\n                autocomplete=\"off\"\n                :rules=\"validateDuration(date)\"\n                :model-value=\"getDuration(record.dates[date])\"\n                @blur=\"onDurationBlur\"\n                @focus=\"onDurationFocus(i, date)\"\n                @update:model-value=\"updateTime($event, i, date)\"\n              />\n              <span v-else>\n                {{ getDuration(record.dates[date]) ?? '00:00' }}\n              </span>\n            </td>\n            <td\n              v-if=\"!editable\"\n              class=\"XHRM-timesheet-table-body-cell --center --freeze-right --highlight\"\n            >\n              {{ record.total.label }}\n            </td>\n            <td v-if=\"editable\" class=\"XHRM-timesheet-table-body-cell --flex\">\n              <oxd-icon-button\n                name=\"trash\"\n                class=\"XHRM-timesheet-icon\"\n                @click=\"deleteRow(i)\"\n              />\n            </td>\n          </tr>\n          <!-- timesheet activities -->\n\n          <!-- totals -->\n          <tr\n            v-if=\"!editable && records.length > 0\"\n            class=\"XHRM-timesheet-table-body-row --total\"\n          >\n            <td\n              class=\"XHRM-timesheet-table-body-cell --freeze-left --highlight\"\n            >\n              {{ $t('general.total') }}\n            </td>\n            <td></td>\n            <!-- total per day -->\n            <td\n              v-for=\"date in columns\"\n              :key=\"`total-${date}`\"\n              class=\"XHRM-timesheet-table-body-cell --center\"\n            >\n              {{ date.total.label }}\n            </td>\n            <!-- total per day -->\n            <td\n              class=\"XHRM-timesheet-table-body-cell --center --freeze-right --highlight-2\"\n            >\n              {{ subtotal }}\n            </td>\n          </tr>\n          <!-- totals -->\n\n          <!-- add row -->\n          <tr v-if=\"editable\" class=\"XHRM-timesheet-table-body-row\">\n            <td class=\"XHRM-timesheet-table-body-cell --flex\">\n              <oxd-icon-button\n                name=\"plus\"\n                class=\"XHRM-timesheet-icon\"\n                @click=\"addRow\"\n              />\n              <oxd-text type=\"subtitle-2\">\n                {{ $t('time.add_row') }}\n              </oxd-text>\n            </td>\n          </tr>\n          <!-- add row -->\n\n          <tr v-if=\"records.length === 0\" class=\"XHRM-timesheet-table-body-row\">\n            <td colspan=\"9\" class=\"XHRM-timesheet-table-body-cell\">\n              {{ $t('general.no_records_found') }}\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n\n    <div class=\"XHRM-timesheet-footer\">\n      <div class=\"XHRM-timesheet-footer--title\">\n        <slot name=\"footer-title\"></slot>\n      </div>\n      <div class=\"XHRM-timesheet-footer--options\">\n        <slot name=\"footer-options\"></slot>\n      </div>\n    </div>\n\n    <timesheet-comment-modal\n      v-if=\"showCommentModal\"\n      :editable=\"editable\"\n      :data=\"commentModalState\"\n      :timesheet-id=\"timesheetId\"\n      @close=\"onCommentModalClose\"\n    ></timesheet-comment-modal>\n  </oxd-form>\n</template>\n\n<script>\nimport {validSelection} from '@/core/util/validation/rules';\nimport {parseDate, parseTimeInSeconds} from '@ohrm/core/util/helper/datefns';\nimport ActivityDropdown from '@/XHRMTimePlugin/components/ActivityDropdown.vue';\nimport ProjectAutocomplete from '@/XHRMTimePlugin/components/ProjectAutocomplete.vue';\nimport TimesheetCommentModal from '@/XHRMTimePlugin/components/TimesheetCommentModal.vue';\nimport {OxdAlert, OxdSpinner} from '@ohrm/oxd';\n\nexport default {\n  name: 'Timesheet',\n\n  components: {\n    'oxd-alert': OxdAlert,\n    'oxd-loading-spinner': OxdSpinner,\n    'activity-dropdown': ActivityDropdown,\n    'project-autocomplete': ProjectAutocomplete,\n    'timesheet-comment-modal': TimesheetCommentModal,\n  },\n\n  props: {\n    records: {\n      type: Array,\n      default: () => [],\n    },\n    columns: {\n      type: Object,\n      required: false,\n      default: () => null,\n    },\n    subtotal: {\n      type: String,\n      required: false,\n      default: null,\n    },\n    editable: {\n      type: Boolean,\n      default: false,\n    },\n    loading: {\n      type: Boolean,\n      default: false,\n    },\n    timesheetId: {\n      type: Number,\n      default: null,\n    },\n  },\n\n  emits: ['update:records'],\n\n  data() {\n    return {\n      focusedField: null,\n      showCommentModal: false,\n      commentModalState: null,\n      rules: {\n        project: [\n          validSelection,\n          (v) => v !== null || this.$t('time.select_a_project'),\n        ],\n        activity: [\n          (v) => v !== null || this.$t('time.select_an_activity'),\n          (v) =>\n            this.records.filter((record) => record.activity?.id === v?.id)\n              .length < 2 || this.$t('time.duplicate_record'),\n        ],\n      },\n    };\n  },\n\n  computed: {\n    days() {\n      return this.columns ? Object.keys(this.columns) : [];\n    },\n    dailyTotals() {\n      const totals = {};\n      for (const date in this.columns) {\n        totals[date] = this.records.reduce((acc, record) => {\n          const duration = parseTimeInSeconds(record.dates[date]?.duration);\n          return duration > 0 ? acc + duration : acc;\n        }, 0);\n      }\n      return totals;\n    },\n    daysOfWeek() {\n      const days = [\n        this.$t('general.sun'),\n        this.$t('general.mon'),\n        this.$t('general.tue'),\n        this.$t('general.wed'),\n        this.$t('general.thu'),\n        this.$t('general.fri'),\n        this.$t('general.sat'),\n      ];\n      return this.days.map((day) => {\n        const date = parseDate(day, 'yyyy-MM-dd');\n        return {\n          id: date.valueOf(),\n          day: date.getDate(),\n          title: days[date.getDay()],\n        };\n      });\n    },\n    tableClasses() {\n      return {\n        'XHRM-timesheet-table': true,\n        '--editable': this.editable,\n      };\n    },\n    fixedColumnClasses() {\n      return {\n        'XHRM-timesheet-table-header-cell': true,\n        '--freeze-left': !this.editable,\n      };\n    },\n    fixedCellClasses() {\n      return {\n        'XHRM-timesheet-table-body-cell': true,\n        '--freeze-left': !this.editable,\n      };\n    },\n  },\n\n  methods: {\n    deleteRow(index) {\n      const updated = this.records.filter((_, i) => i !== index);\n      this.syncRecords(updated);\n      this.$nextTick().then(() => {\n        if (updated.length === 0) this.addRow();\n      });\n    },\n    addRow() {\n      const updated = [\n        ...this.records,\n        {\n          project: null,\n          activity: null,\n          dates: {},\n        },\n      ];\n      this.syncRecords(updated);\n    },\n    updateTime($value, index, date) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          const _date = {\n            [date]: {\n              date: date,\n              duration: $value,\n              id: record.dates[date]?.id,\n              comment: record.dates[date]?.comment,\n            },\n          };\n          record.dates = {...record.dates, ..._date};\n        }\n        return record;\n      });\n      this.syncRecords(updated);\n    },\n    updateComment(id, comment, index, date) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          const _date = {\n            [date]: {\n              id: id,\n              date: date,\n              comment: comment,\n              duration: record.dates[date]?.duration,\n            },\n          };\n          record.dates = {...record.dates, ..._date};\n        }\n        return record;\n      });\n      this.syncRecords(updated);\n    },\n    updateProject($value, index) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          record.project = $value ? $value : null;\n          record.customer = $value?._customer ? $value._customer : null;\n        }\n        return record;\n      });\n      this.updateActivity(null, index);\n      this.syncRecords(updated);\n    },\n    updateActivity($value, index) {\n      const updated = this.records.map((record, i) => {\n        if (i === index) {\n          record.activity = $value ? {id: $value.id, name: $value.label} : null;\n        }\n        return record;\n      });\n      this.syncRecords(updated);\n    },\n    syncRecords(updated) {\n      if (!this.editable) return;\n      this.$emit('update:records', updated);\n    },\n    viewComment(record, entry, index, date) {\n      if (record.project?.id && record.activity?.id) {\n        this.commentModalState = {\n          date,\n          index,\n          id: entry?.id,\n          project: record.project,\n          activity: record.activity,\n          customer: record.customer,\n        };\n        this.showCommentModal = true;\n      } else {\n        this.$toast.warn({\n          title: this.$t('general.warning'),\n          message: this.$t('time.select_a_project_and_an_activity'),\n        });\n      }\n    },\n    onCommentModalClose($event) {\n      if ($event) {\n        const {id, comment} = $event;\n        const {index, date} = this.commentModalState;\n        this.updateComment(id, comment, index, date);\n      }\n      this.showCommentModal = false;\n      this.commentModalState = null;\n    },\n    getProject(record) {\n      const {project, customer} = record;\n      if (project && project.label) {\n        return project;\n      }\n      if (project && customer) {\n        return {\n          id: project.id,\n          label: `${customer.name} - ${project.name}`,\n        };\n      }\n      return null;\n    },\n    getActivity(activity) {\n      return activity ? {id: activity.id, label: activity.name} : null;\n    },\n    getDuration(entry) {\n      // TODO: convert to format from user config\n      return entry?.duration ? entry.duration : null;\n    },\n    getCommentIcon(entry) {\n      return entry?.comment ? 'chat-dots-fill' : 'chat-dots';\n    },\n    isCommentVisible(entry, index, date) {\n      if (entry?.comment) return true;\n      if (this.editable) {\n        return (\n          this.focusedField &&\n          this.focusedField.index === index &&\n          this.focusedField.date === date\n        );\n      }\n      return false;\n    },\n    onDurationFocus(index, date) {\n      this.focusedField = {index, date};\n    },\n    onDurationBlur() {\n      this.focusedField = null;\n    },\n    validateDuration(date) {\n      const validateFormat = (v) => {\n        return (\n          v === '' ||\n          v === null ||\n          parseTimeInSeconds(v) >= 0 ||\n          this.$t('time.should_be_less_than_24_and_in_hh_mm_or_decimal_format')\n        );\n      };\n\n      const validateTotal = () => {\n        return this.dailyTotals[date] > 86400\n          ? this.$t('time.total_should_be_less_than_24_hours')\n          : true;\n      };\n\n      return [validateFormat, validateTotal];\n    },\n  },\n};\n</script>\n\n<style src=\"./timesheet.scss\" lang=\"scss\" scoped></style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}