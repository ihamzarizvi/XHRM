{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, resolveDynamicComponent as _resolveDynamicComponent, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"XHRM-leave-balance\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_oxd_label = _resolveComponent(\"oxd-label\");\n  const _component_oxd_icon_button = _resolveComponent(\"oxd-icon-button\");\n  const _component_oxd_text = _resolveComponent(\"oxd-text\");\n  const _component_oxd_input_group = _resolveComponent(\"oxd-input-group\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_oxd_input_group, null, {\n    label: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_oxd_label, {\n      label: _ctx.$t('leave.leave_balance')\n    }, null, 8, [\"label\"]), $props.leaveData.type ? (_openBlock(), _createBlock(_component_oxd_icon_button, {\n      key: 0,\n      class: \"--help\",\n      name: \"question-circle\",\n      \"with-container\": false,\n      onClick: $setup.onModalOpen\n    }, null, 8, [\"onClick\"])) : _createCommentVNode(\"\", true)])]),\n    default: _withCtx(() => [_ctx.balance >= 0 ? (_openBlock(), _createBlock(_component_oxd_text, {\n      key: 0,\n      class: \"XHRM-leave-balance-text\",\n      tag: \"p\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.leaveBalance), 1)]),\n      _: 1\n    })) : (_openBlock(), _createBlock(_component_oxd_text, {\n      key: 1,\n      class: \"XHRM-leave-balance-text --error\",\n      tag: \"p\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('leave.balance_not_sufficient')), 1)]),\n      _: 1\n    }))]),\n    _: 1\n  }), _ctx.showModal ? (_openBlock(), _createBlock(_resolveDynamicComponent($setup.leaveBalanceModal), {\n    key: 0,\n    data: _ctx.data,\n    meta: _ctx.meta,\n    onClose: $setup.onModalClose\n  }, null, 40, [\"data\", \"meta\", \"onClose\"])) : _createCommentVNode(\"\", true)], 64);\n}","map":{"version":3,"names":["class","_createVNode","_component_oxd_input_group","label","_withCtx","_createElementVNode","_hoisted_1","_component_oxd_label","_ctx","$t","$props","leaveData","type","_createBlock","_component_oxd_icon_button","name","onClick","$setup","onModalOpen","balance","_component_oxd_text","tag","leaveBalance","showModal","_resolveDynamicComponent","leaveBalanceModal","data","meta","onClose","onModalClose"],"sources":["C:\\Users\\x\\Documents\\Projects\\HRM\\XHRM\\src\\client\\src\\XHRMLeavePlugin\\components\\LeaveBalance.vue"],"sourcesContent":["<!--\n/**\n * XHRM is a comprehensive Human Resource Management (HRM) System that captures\n * all the essential functionalities required for any enterprise.\n * Copyright (C) 2006 XHRM Inc., http://www.XHRM.com\n *\n * XHRM is free software: you can redistribute it and/or modify it under the terms of\n * the GNU General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or (at your option) any later version.\n *\n * XHRM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along with XHRM.\n * If not, see <https://www.gnu.org/licenses/>.\n */\n -->\n\n<template>\n  <oxd-input-group>\n    <template #label>\n      <div class=\"XHRM-leave-balance\">\n        <oxd-label :label=\"$t('leave.leave_balance')\" />\n        <oxd-icon-button\n          v-if=\"leaveData.type\"\n          class=\"--help\"\n          name=\"question-circle\"\n          :with-container=\"false\"\n          @click=\"onModalOpen\"\n        />\n      </div>\n    </template>\n    <oxd-text v-if=\"balance >= 0\" class=\"XHRM-leave-balance-text\" tag=\"p\">\n      {{ leaveBalance }}\n    </oxd-text>\n    <oxd-text v-else class=\"XHRM-leave-balance-text --error\" tag=\"p\">\n      {{ $t('leave.balance_not_sufficient') }}\n    </oxd-text>\n  </oxd-input-group>\n  <component\n    :is=\"leaveBalanceModal\"\n    v-if=\"showModal\"\n    :data=\"data\"\n    :meta=\"meta\"\n    @close=\"onModalClose\"\n  ></component>\n</template>\n\n<script>\nimport {toRefs, reactive, computed, watchPostEffect} from 'vue';\nimport {APIService} from '@ohrm/core/util/services/api.service';\nimport LeaveBalanceModal from '@/XHRMLeavePlugin/components/LeaveBalanceModal';\nimport LeaveBalanceInsufficientModal from '@/XHRMLeavePlugin/components/LeaveBalanceInsufficientModal';\nimport useLeaveValidators from '@/XHRMLeavePlugin/util/composable/useLeaveValidators';\nimport {OxdLabel} from '@ohrm/oxd';\n\nexport default {\n  name: 'LeaveBalance',\n  components: {\n    'oxd-label': OxdLabel,\n    'leave-balance-modal': LeaveBalanceModal,\n    'leave-balance-insufficient-modal': LeaveBalanceInsufficientModal,\n  },\n  inheritAttrs: false,\n  props: {\n    leaveData: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  setup(props) {\n    const state = reactive({\n      data: null,\n      meta: null,\n      balance: 0,\n      showModal: false,\n    });\n    const http = new APIService(\n      window.appGlobal.baseUrl,\n      '/api/v2/leave/leave-balance/leave-type',\n    );\n    http.setIgnorePath('/api/v2/leave/leave-balance/leave-type');\n    const {validateLeaveBalance} = useLeaveValidators(http);\n\n    const leaveBalance = computed(() => {\n      return props.leaveData.type?.id\n        ? `${state.balance.toFixed(2)} Day(s)`\n        : '0.00 Day(s)';\n    });\n\n    const onModalOpen = () => {\n      state.showModal = true;\n    };\n\n    const onModalClose = () => {\n      state.showModal = false;\n    };\n\n    const leaveBalanceModal = computed(() => {\n      return Array.isArray(state.data)\n        ? 'leave-balance-insufficient-modal'\n        : 'leave-balance-modal';\n    });\n\n    watchPostEffect(async () => {\n      if (props.leaveData.type?.id) {\n        validateLeaveBalance(props.leaveData)\n          .then(({balance, breakdown, metaData}) => {\n            state.balance = balance;\n            if (breakdown) state.data = breakdown;\n            if (metaData) state.meta = metaData;\n          })\n          .catch(() => {\n            state.data = null;\n            state.meta = null;\n            state.balance = 0;\n          });\n      }\n    });\n\n    return {\n      ...toRefs(state),\n      leaveBalance,\n      onModalOpen,\n      onModalClose,\n      leaveBalanceModal,\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.XHRM-leave-balance {\n  display: flex;\n  align-items: center;\n  & .--help {\n    margin-left: 5px;\n  }\n}\n.XHRM-leave-balance-text {\n  padding: $oxd-input-control-vertical-padding 0rem;\n  &.--error {\n    color: $oxd-feedback-danger-color;\n  }\n}\n</style>\n"],"mappings":";;EAsBWA,KAAK,EAAC;AAAoB;;;;;;6DAFnCC,YAAA,CAmBkBC,0BAAA;IAlBLC,KAAK,EAAAC,QAAA,CACd,MASM,CATNC,mBAAA,CASM,OATNC,UASM,GARJL,YAAA,CAAgDM,oBAAA;MAApCJ,KAAK,EAAEK,IAAA,CAAAC,EAAE;4BAEbC,MAAA,CAAAC,SAAS,CAACC,IAAI,I,cADtBC,YAAA,CAMEC,0BAAA;;MAJAd,KAAK,EAAC,QAAQ;MACde,IAAI,EAAC,iBAAiB;MACrB,gBAAc,EAAE,KAAK;MACrBC,OAAK,EAAEC,MAAA,CAAAC;;sBAAJ,MAIO,CAADV,IAAA,CAAAW,OAAO,S,cAAvBN,YAAA,CAEWO,mBAAA;;MAFmBpB,KAAK,EAAC,yBAAyB;MAACqB,GAAG,EAAC;;wBAChE,MAAkB,C,kCAAfJ,MAAA,CAAAK,YAAY,M;;yBAEjBT,YAAA,CAEWO,mBAAA;;MAFMpB,KAAK,EAAC,iCAAiC;MAACqB,GAAG,EAAC;;wBAC3D,MAAwC,C,kCAArCb,IAAA,CAAAC,EAAE,sC;;;;MAKDD,IAAA,CAAAe,SAAS,I,cAFjBV,YAAA,CAMaW,wBAAA,CALNP,MAAA,CAAAQ,iBAAiB;;IAErBC,IAAI,EAAElB,IAAA,CAAAkB,IAAI;IACVC,IAAI,EAAEnB,IAAA,CAAAmB,IAAI;IACVC,OAAK,EAAEX,MAAA,CAAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}